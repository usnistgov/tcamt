<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:tcamt="http://java.sun.com/jsf/composite/tcamt">

<composite:interface>
	<composite:attribute name="bean" />
	<composite:attribute name="panelId" />
</composite:interface>

<composite:implementation>
	<p:treeTable value="#{cc.attrs.bean.segmentTreeRoot}" var="model" resizableColumns="true"
		rowStyleClass="#{model.data == null or model.data == ''? 'zeroOccurRow' :'normalRow' }">
	
			<!-- rowStyleClass="#{model.occurrence lt 0 or model.occurrence == 0? 'zeroOccurRow' : (model.node.usage == 'X' ? 'xUsageRow' : 
		(model.node.usage == 'O' ? 'oUsageRow' : (model.node.usage == 'RE' ? 'reUsageRow' : (model.node.usage == 'R' ? 'rUsageRow' : 'normalRow' ) ) ) )}" -->
		<p:column headerText="Path" style="width:15%;">
			<h:outputText value="#{model.ipath}" />
		</p:column>
		<p:column headerText="Name" style="width:20%;">
			<h:outputText value="#{model.node.name}" />
		</p:column>
		<p:column headerText="DT" style="width:8%; text-align: center;">
			<h:outputText value="#{model.node.datatype.label}" />
		</p:column>
		<p:column headerText="Usage" style="width:7%; text-align: center;">
			<h:outputText value="#{model.node.usage}" />
		</p:column>
		<p:column headerText="Cardinality"
			style="width:8%; text-align: center;">
			<h:outputText
				rendered="#{model.node.getClass().getSimpleName() == 'Field'}"
				value="[#{model.node.min} ~ " />
			<h:outputText
				rendered="#{model.node.getClass().getSimpleName() == 'Field'}"
				value="#{model.node.max}]" />
		</p:column>
		<p:column headerText="Length" style="width:8%; text-align: center;">
			<h:outputText rendered="#{model.leafNode}"
				value="[#{model.node.minLength} ~ " />
			<h:outputText rendered="#{model.leafNode}"
				value="#{model.node.maxLength}]" />
		</p:column>
		<p:column headerText="Value Set" style="width:10%; text-align: center;">
			<h:outputText value="#{model.node.table.mappingId}" />
		</p:column>
		
		<p:column headerText="Test Data" style="width:7%; text-align: center;">
			<h:outputText rendered="#{model.path=='MSH.1' or model.path=='MSH.2'}"  style="width:90%;" value="#{model.data}" />
			<p:inputText rendered="#{model.leafNode and model.path!='MSH.1' and model.path!='MSH.2' and model.node.table == null}"  style="width:90%;" value="#{model.data}">
				<p:ajax event="blur" listener="#{cc.attrs.bean.updateInstanceData(model)}" update="#{cc.attrs.panelId}" />
			</p:inputText>
			<p:selectOneMenu value="#{model.data}" effect="fade" style="width:100%;" editable="true" rendered="#{model.leafNode and model.path!='MSH.1' and model.path!='MSH.2' and model.node.table != null}">
				<f:selectItem itemLabel="Select One" itemValue="" />
				<f:selectItems value="#{model.node.table.codes}" var="code" itemLabel="#{code.code}" itemValue="#{code.code}" />
				<p:ajax event="blur" listener="#{cc.attrs.bean.updateInstanceData(model)}" update="#{cc.attrs.panelId}" />
				<p:ajax event="change" listener="#{cc.attrs.bean.updateInstanceData(model)}" update="#{cc.attrs.panelId}" />
			</p:selectOneMenu>
		</p:column>
		
		<p:column headerText="TestData Cate." style="width:8%; text-align: center;">
			<p:selectOneMenu value="#{model.tdc}" effect="fade" style="width:100%;" rendered="#{model.leafNode and model.checkTestDataCategorizationAvaiablility()}">
				<f:selectItem itemLabel="Select One" itemValue="" />
				<f:selectItem itemLabel="Indifferent" itemValue="Indifferent" />
				<f:selectItem itemLabel="Content Indifferent" itemValue="ContentIndifferent" />
				<f:selectItem itemLabel="Configurable" itemValue="Configurable" />
				<f:selectItem itemLabel="System Generated" itemValue="SystemGenerated" />
				<f:selectItem itemLabel="Test Case Proper" itemValue="TestCaseProper" />
				<f:selectItem itemLabel="Not-Valued" itemValue="NotValued" />
				<f:selectItem itemLabel="Test Case Fixed" itemValue="TestCaseFixed" />
				<f:selectItem itemLabel="Test Case Fixed - List" itemValue="TestCaseFixedList" />
				<f:selectItem itemLabel="Test Case Fixed - Length" itemValue="TestCaseFixedLength" />
 				<p:ajax event="change" listener="#{cc.attrs.bean.createTCAMTConstraint(model)}" update="#{cc.attrs.panelId}" />
			</p:selectOneMenu>
		</p:column>
		
		<p:column headerText="Action" style="width:3%; text-align: center;">
			<p:commandButton icon="ui-icon-plus" rendered="#{model.node.getClass().getSimpleName() == 'Field' and model.node.max == '*'}" update="#{cc.attrs.panelId}" actionListener="#{cc.attrs.bean.addRepeatedField(model)}" />
		</p:column>
	</p:treeTable>
</composite:implementation>

</html>