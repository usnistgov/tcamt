<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:tcamt="http://java.sun.com/jsf/composite/tcamt">

<composite:interface>
</composite:interface>

<composite:implementation>
	<h:form id="listTestPlanForm">
		<p:accordionPanel widgetVar="TestPlanCasePanel">
			<p:tab title="TestPlan DashBoard">
			<p:scrollPanel style="width:100%;height:700px;border:0px" mode="native">
				<table width="100%">
					<tr>
						<td align="right"><p:commandButton
								value="Create New TestPlan" icon="ui-icon-plus"
								update=":#{p:component('createTestPlanForm')}"
								actionListener="#{testPlanRequestBean.createTestPlan}"
								oncomplete="PF('createTestPlan').show();" /></td>
					</tr>
				</table>

				<p:dataTable id="testPlanList" var="testPlan" value="#{testPlanRequestBean.testPlans}">
					<p:column headerText="Name">
						<h:outputText value="#{testPlan.name}" />
					</p:column>

					<p:column headerText="Description">
						<h:outputText value="#{testPlan.description}" />
					</p:column>

					<p:column headerText="Test Cases">
						<h:outputText value="#{testPlan.testCases.size()} TestCases" />
						<p:dataTable var="tcid" value="#{testPlan.testCases}" rowIndexVar="rowIndex">
							<p:column headerText="TestCase Name">
								<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).name}" />
							</p:column>
							<p:column headerText="TestCase Type">
								<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).type}" />
							</p:column>
							<p:column headerText="TestScenario">
								<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).testScenario}" />
							</p:column>
							<p:column headerText="TestCase Description">
								<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).description}" />
							</p:column>
							<p:column headerText="Diagram">
								<p:graphicImage id="diagramList" name="images/sequenceDiagram.bmp" style="cursor:pointer" width="50"/>
								<p:overlayPanel id="diagramListPanel" for="diagramList" my="left center" at="right bottom" showEffect="blind" hideEffect="explode" showEvent="mouseover" hideEvent="mouseleave" dismissable="false" showCloseIcon="true">
                					<p:graphicImage value="#{testCaseRequestBean.loadUMLD(testPlanRequestBean.findTestCase(tcid))}" cache="false" >
							 			<f:param name="code" value="#{testPlanRequestBean.findTestCase(tcid).umld}" />
									</p:graphicImage>
    							</p:overlayPanel>
							</p:column>
						</p:dataTable>
					</p:column>

					<p:column headerText="Version">
						<h:outputText value="#{testPlan.version}" />
					</p:column>

					<p:column headerText="Action">
						<p:commandButton value="Edit" icon="ui-icon-pencil" update=":#{p:component('editTestPlanForm')}" actionListener="#{testPlanRequestBean.selectEditTestPlan}"	oncomplete="PF('editTestPlan').show();">
							<f:attribute name="testPlan" value="#{testPlan}" />
						</p:commandButton>
						
						<p:commandButton value="Export TestPlan Resource Bundle as ZIP" ajax="false"
							actionListener="#{testCaseRequestBean.downloadResourceBundleForTestPlan(testPlan)}" icon="ui-icon-disk">
							<p:fileDownload value="#{testCaseRequestBean.zipResourceBundleFile}" />
						</p:commandButton>
						
						<p:commandButton value="Cloning" actionListener="#{testPlanRequestBean.cloneTestPlan}" update=":#{p:component('listTestPlanForm')}" icon="ui-icon-plus" title="Cloning">
							<f:attribute name="testPlan" value="#{testPlan}" />
						</p:commandButton>
						
 						<p:commandButton
									value="Sharing" icon="ui-icon-transfer-e-w"
									update=":#{p:component('shareTestPlanForm')}"
									actionListener="#{testPlanRequestBean.selectEditTestPlan}"
									oncomplete="PF('shareTestPlan').show();" >
									<f:attribute name="testPlan" value="#{testPlan}" />
						</p:commandButton>

						<p:commandButton value="Del" actionListener="#{testPlanRequestBean.delTestPlan}" update=":#{p:component('listTestPlanForm')}" icon="ui-icon-close" title="Del">
							<f:attribute name="testPlan" value="#{testPlan}" />
						</p:commandButton>
					</p:column>
				</p:dataTable>
			</p:scrollPanel>
			</p:tab>
		</p:accordionPanel>
	</h:form>

	<h:form id="createTestPlanForm">
		<p:dialog modal="true" id="createTestPlanDialog" header="Create TestPlan" widgetVar="createTestPlan">
			<h:panelGrid id="creatTestPlanPanel" columns="3" cellpadding="5">
				<h:outputText value="Name: " />
				<p:inputText value="#{testPlanRequestBean.newTestPlan.name}"/>
				<h:outputText value=" " />
				
				<h:outputText value="Description: " />
				<p:inputText value="#{testPlanRequestBean.newTestPlan.description}"/>
				<h:outputText value=" " />
				
				<h:outputText value="TestCase: " />
				<p:selectOneMenu id="selectOneTestCase" value="#{testPlanRequestBean.testCaseId}">
					<f:selectItem itemLabel="Select One" itemValue="" />
					<f:selectItems value="#{testCaseRequestBean.testCases}" var="testcase" itemLabel="#{testcase.name}" itemValue="#{testcase.id}" />
				</p:selectOneMenu>
				<p:commandButton value="Add Test Case" update=":#{p:component('selectOneTestCase')} :#{p:component('ListTestCase')}" actionListener="#{testPlanRequestBean.addTestCase}" styleClass="ui-priority-primary" />
				
			</h:panelGrid>
			
			<p:dataTable id="ListTestCase" var="tcid" value="#{testPlanRequestBean.newTestPlan.testCases}" rowIndexVar="rowIndex">
				<p:column headerText="TestCase Name">
					<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).name}" />
				</p:column>
				<p:column headerText="TestCase Type">
					<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).type}" />
				</p:column>
				<p:column headerText="Test Scenario">
					<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).testScenario}" />
				</p:column>
				<p:column headerText="TestCase Description">
					<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).description}" />
				</p:column>
				<p:column headerText="Diagram">
					<p:graphicImage id="diagramListNew" name="images/sequenceDiagram.bmp" style="cursor:pointer" width="50"/>
					<p:overlayPanel id="diagramListNewPanel" for="diagramListNew" my="left center" at="right bottom" showEffect="blind" hideEffect="explode" showEvent="mouseover" hideEvent="mouseleave" dismissable="false" showCloseIcon="true">
                		<p:graphicImage value="#{testCaseRequestBean.loadUMLD(testPlanRequestBean.findTestCase(tcid))}" cache="false" >
							<f:param name="code" value="#{testPlanRequestBean.findTestCase(tcid).umld}" />
						</p:graphicImage>
    				</p:overlayPanel>
				</p:column>
				<p:column headerText="Action">
					<p:commandButton icon="ui-icon-close" update=":#{p:component('ListTestCase')}" actionListener="#{testPlanRequestBean.delTestCase}" styleClass="ui-priority-primary">
						<f:attribute name="num" value="#{rowIndex}" />
					</p:commandButton>
				</p:column>
			</p:dataTable>
			

			<table width="100%">
				<tr>
					<td align="right">
						<p:commandButton value="Create" icon="ui-icon-plus" update=":#{p:component('testPlanList')}" actionListener="#{testPlanRequestBean.addTestPlan}" onclick="PF('createTestPlan').hide();" />
					</td>
				</tr>
			</table>
		</p:dialog>
	</h:form>
	
	<h:form id="shareTestPlanForm">
		<p:dialog id="shareTestPlanDialog" header="Share TestPlan"
			widgetVar="shareTestPlan">
			<h:panelGrid id="shareTestPlanPanel" columns="2" cellpadding="5">
				<h:outputText value="To: " />
				
				<p:selectOneMenu
					value="#{testPlanRequestBean.shareTo}"
					effect="fade">
					<f:selectItem itemLabel="Select One" itemValue="" />
					<f:selectItems value="#{userControl.users}" var="user" itemLabel="#{user}" itemValue="#{user}" />
				</p:selectOneMenu>
			</h:panelGrid>

			<table width="100%">
				<tr>
					<td align="right">
						<p:commandButton
							value="Share" icon="ui-icon-plus"
							update=":#{p:component('testPlanList')}"
							actionListener="#{testPlanRequestBean.shareTestPlan}"
							onclick="PF('shareTestPlan').hide();" />
					</td>
				</tr>
			</table>
		</p:dialog>
	</h:form>
	
	<h:form id="editTestPlanForm">
		<p:dialog modal="true" id="editTestPlanDialog" header="Edit TestPlan" widgetVar="editTestPlan">
			<h:panelGrid id="editTestPlanPanel" columns="2" cellpadding="5">
				<h:outputText value="Name: " />
				<p:inputText value="#{testPlanRequestBean.editTestPlan.name}"/>
				
				<h:outputText value="Description: " />
				<p:inputText value="#{testPlanRequestBean.editTestPlan.description}"/>
			
				<p:selectOneMenu id="selectOneTestCaseEdit" value="#{testPlanRequestBean.testCaseId}">
					<f:selectItem itemLabel="Select One" itemValue="" />
					<f:selectItems value="#{testCaseRequestBean.testCases}" var="testcase" itemLabel="#{testcase.name}" itemValue="#{testcase.id}" />
				</p:selectOneMenu>
				<p:commandButton value="Add Test Case" update=":#{p:component('selectOneTestCaseEdit')} :#{p:component('ListTestCaseEdit')}" actionListener="#{testPlanRequestBean.addTestCaseEdit}" styleClass="ui-priority-primary" />
			</h:panelGrid>
			
			<p:dataTable id="ListTestCaseEdit" var="tcid" value="#{testPlanRequestBean.editTestPlan.testCases}" rowIndexVar="rowIndex">
				<p:column headerText="TestCase Name">
					<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).name}" />
				</p:column>
				<p:column headerText="TestCase Type">
					<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).type}" />
				</p:column>
				<p:column headerText="TestCase Type">
					<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).testScenario}" />
				</p:column>
				<p:column headerText="TestCase Description">
					<h:outputText value="#{testPlanRequestBean.findTestCase(tcid).description}" />
				</p:column>
				<p:column headerText="Diagram">
					<p:graphicImage id="diagramListEdit" name="images/sequenceDiagram.bmp" style="cursor:pointer" width="50"/>
					<p:overlayPanel id="diagramListEditPanel" for="diagramListEdit" my="left center" at="right bottom" showEffect="blind" hideEffect="explode" showEvent="mouseover" hideEvent="mouseleave" dismissable="false" showCloseIcon="true">
                		<p:graphicImage value="#{testCaseRequestBean.loadUMLD(testPlanRequestBean.findTestCase(tcid))}" cache="false" >
							<f:param name="code" value="#{testPlanRequestBean.findTestCase(tcid).umld}" />
						</p:graphicImage>
    				</p:overlayPanel>
				</p:column>
				<p:column headerText="Action">
					<p:commandButton icon="ui-icon-close" update=":#{p:component('ListTestCaseEdit')}" actionListener="#{testPlanRequestBean.delTestCaseEdit}" styleClass="ui-priority-primary">
						<f:attribute name="num" value="#{rowIndex}" />
					</p:commandButton>
				</p:column>
			</p:dataTable>
			

			<table width="100%">
				<tr>
					<td align="right">
						<p:commandButton value="Apply" icon="ui-icon-plus" update=":#{p:component('testPlanList')}" actionListener="#{testPlanRequestBean.updateTestPlan}" onclick="PF('editTestPlan').hide();" />
					</td>
				</tr>
			</table>
		</p:dialog>
	</h:form>

</composite:implementation>

</html>